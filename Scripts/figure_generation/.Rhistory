file = vcgImport(file_name)
plot3d(file, color = 'white', axes = FALSE, xlab = '',ylab = '',zlab='',specular = 'black')
rgl.bg(color = 'lightblue')
rgl.viewpoint(userMatrix =rotation_matrix)
}
for (file_name in microcebus_files){
file = vcgImport(file_name)
plot3d(file, color = 'white', axes = FALSE, xlab = '',ylab = '',zlab='',specular = 'black')
rgl.bg(color = 'rosybrown1')
rgl.viewpoint(userMatrix =rotation_matrix)
}
for (file_name in mirza_files){
file = vcgImport(file_name)
plot3d(file, color = 'white', axes = FALSE, xlab = '',ylab = '',zlab='',specular = 'black')
rgl.bg(color = 'lightgreen')
rgl.viewpoint(userMatrix =rotation_matrix)
}
for (file_name in saimiri_files){
file = vcgImport(file_name)
plot3d(file, color = 'white', axes = FALSE, xlab = '',ylab = '',zlab='',specular = 'black')
rgl.bg(color = 'gold')
rgl.viewpoint(userMatrix =rotation_matrix)
}
#### Day 2 ####
g = read.csv('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/scBactoSeq/data/qPCR/Efficiency/RT_efficiency0828_clean.csv')
g = g[,-1]
g = g[,-7]
g = g[,-6]
g[,2] = as.character(g[,2])
g = subset(g,subset = Sample!="Post_Fixation")
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
g$Sample = factor(g$Sample, levels = c('Post_Fixation','Pre_RT','Post_RT','Tween_0.01','Tween_0.05','Tween_0.1','1_hour_42'))
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
#### Day 2 ####
g = read.csv('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/scBactoSeq/data/qPCR/Efficiency/RT_efficiency0828_clean.csv')
g = g[,-1]
g = g[,-7]
g = g[,-6]
g[,2] = as.character(g[,2])
g = subset(g,subset = Sample!="Post_Fixation")
#### Day 2 ####
g = read.csv('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/scBactoSeq/data/qPCR/Efficiency/RT_efficiency0828_clean.csv')
g = g[,-1]
g = g[,-7]
g = g[,-6]
g[,2] = as.character(g[,2])
g$Sample = factor(g$Sample, levels = c('Post_Fixation','Pre_RT','Post_RT','Tween_0.01','Tween_0.05','Tween_0.1','1_hour_42'))
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
#### Day 2 ####
g = read.csv('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/scBactoSeq/data/qPCR/Efficiency/RT_efficiency0828_clean.csv')
g = g[,-1]
g = g[,-7]
g = g[,-6]
g[,2] = as.character(g[,2])
g$Sample = factor(g$Sample, levels = c('Post_Fixation','Pre_RT','Post_RT','Tween_0.01','Tween_0.05','Tween_0.1','1_hour_42'))
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
#### Day 2 ####
g = read.csv('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/scBactoSeq/data/qPCR/Efficiency/RT_efficiency0828_clean.csv')
g = g[,-1]
g = g[,-7]
g = g[,-6]
g[,2] = as.character(g[,2])
g = subset(g,subset = Sample!="Post_Fixation")
#g$Sample = factor(g$Sample, levels = c('Post_Fixation','Pre_RT','Post_RT','Tween_0.01','Tween_0.05','Tween_0.1','1_hour_42'))
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
#### Day 2 ####
g = read.csv('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/scBactoSeq/data/qPCR/Efficiency/RT_efficiency0828_clean.csv')
g = g[,-1]
g = g[,-7]
g = g[,-6]
g[,2] = as.character(g[,2])
#g$Sample = factor(g$Sample, levels = c('Post_Fixation','Pre_RT','Post_RT','Tween_0.01','Tween_0.05','Tween_0.1','1_hour_42'))
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
#### Day 2 ####
g = read.csv('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/scBactoSeq/data/qPCR/Efficiency/RT_efficiency0828_clean.csv')
g = g[,-1]
g = g[,-7]
g = g[,-6]
g[,2] = as.character(g[,2])
#g$Sample = factor(g$Sample, levels = c('Post_Fixation','Pre_RT','Post_RT','Tween_0.01','Tween_0.05','Tween_0.1','1_hour_42'))
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
g$Sample = factor(g$Sample, levels = c('Post_Fixation','Pre_RT','Post_RT','Tween_0.01','Tween_0.05','Tween_0.1','1_hour_42'))
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Relative Abundance (Compared to Pre RT Cells)")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "Relative Abundance", color = "Method") +
ggtitle(sprintf("Relative Abundance of 5s rRNA (compared to Pre-RT Cells)")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
gsub("_", " ", x)
gsub('_',' ',g$Sample)
#g = subset(g,subset = Sample!="Post_Fixation")
g$Sample = gsub('_',' ',g$Sample)
g
g$Sample = factor(g$Sample, levels = c('PostFixation','Pre RT','Post RT','Tween 0.01','Tween 0.05','Tween 0.1','1 hour 42'))
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "Relative Abundance", color = "Method") +
ggtitle(sprintf("Relative Abundance of 5s rRNA (compared to Pre-RT Cells)")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
#### Day 2 ####
g = read.csv('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/scBactoSeq/data/qPCR/Efficiency/RT_efficiency0828_clean.csv')
g = g[,-1]
g = g[,-7]
g = g[,-6]
g[,2] = as.character(g[,2])
#g = subset(g,subset = Sample!="Post_Fixation")
g$Sample = gsub('_',' ',g$Sample)
g$Sample = factor(g$Sample, levels = c('PostFixation','Pre RT','Post RT','Tween 0.01','Tween 0.05','Tween 0.1','1 hour 42'))
g
#### Day 2 ####
g = read.csv('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/scBactoSeq/data/qPCR/Efficiency/RT_efficiency0828_clean.csv')
g = g[,-1]
g = g[,-7]
g = g[,-6]
g[,2] = as.character(g[,2])
g
#g = subset(g,subset = Sample!="Post_Fixation")
g$Sample = gsub('_',' ',g$Sample)
g
g$Sample = factor(g$Sample, levels = c('Post Fixation','Pre RT','Post RT','Tween 0.01','Tween 0.05','Tween 0.1','1 hour 42'))
ggplot(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "Relative Abundance", color = "Method") +
ggtitle(sprintf("Relative Abundance of 5s rRNA (compared to Pre-RT Cells)")) +
scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
ggsave('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/slides/Figures/2020-09-01/relative_abundance_qpcr.png')
ggplot(data = subset(g, Sample == 'Post_Fixation'), aes(x = `Fixation`, y= `CT_x`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
geom_point(data = g, aes(x = `Fixation`, y= `CT_x`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
#  scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
ggplot(data = subset(g, Sample == 'Post_Fixation'), aes(x = `Fixation`, y= `CT_x`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
#geom_point(data = g, aes(x = `Fixation`, y= `CT_x`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
#  scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
g
subset(g, Sample == 'Post_Fixation')
ggplot(data = subset(g, Sample == 'Post Fixation'), aes(x = `Fixation`, y= `CT_x`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
#geom_point(data = g, aes(x = `Fixation`, y= `CT_x`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
#  scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
ggplot(data = subset(g, Sample == 'Post Fixation'), aes(x = `Fixation`, y= `CT_x`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
#  stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
#geom_point(data = g, aes(x = `Fixation`, y= `CT_x`, fill = `Sample`), position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
#  scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
ggplot(data = subset(g, Sample == 'Post Fixation'), aes(x = `Fixation`, y= `CT_x`, fill = `Sample`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
#  stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
#geom_point(data = g, aes(x = `Fixation`, y= `CT_x`, fill = `Sample`), position =  position_dodge(width = .9))+
geom_point(position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("Delta CT")) +
#  scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
ggplot(data = subset(g, Sample == 'Post Fixation'), aes(x = `Fixation`, y= `CT_x`, fill = `Fixation %`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
#  stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
#geom_point(data = g, aes(x = `Fixation`, y= `CT_x`, fill = `Sample`), position =  position_dodge(width = .9))+
geom_point(position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("CT (Post Fixation)")) +
#  scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
ggplot(data = subset(g, Sample == 'Post Fixation'), aes(x = `Fixation`, y= `CT_x`, fill = `Fixation`)) +
geom_bar( position = "dodge", stat="summary", fun.y = 'mean')+
#  stat_summary(geom = "bar", fun.y = mean, position = "dodge") +
stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge")+
#  geom_bar(data = g, aes(x = `Fixation`, y= `Relative_CT`, fill = `Sample`), position = "dodge", stat="summary", fun.y = 'mean')+
#geom_point(data = g, aes(x = `Fixation`, y= `CT_x`, fill = `Sample`), position =  position_dodge(width = .9))+
geom_point(position =  position_dodge(width = .9))+
#  geom_errorbar(data = g, aes(x = `Fixation`, y= `CT`, fill = `Sample`,ymin = 0, ymax = 30), position =  position_dodge(width = .9))+
scale_fill_brewer(palette = "Set2") +
#  geom_jitter(color="black", size=0.4, alpha=0.9) +
#  geom_line(data = subset(roc_curve_frame, X3 %like% "Max"), aes(x = X1,y = X2,group = X3,color = factor(X3)),alpha = 0.75,  size = 1.5, linetype = 4,position=position_jitter(w=0.01, h=0)) +
# geom_line(stat = "identity",aes(color = factor(X3)), linetype = 'dotted') +
labs(x = "Fixation %", y = "CT", color = "Method") +
ggtitle(sprintf("CT (Post Fixation)")) +
#  scale_y_continuous(trans='log10')+
#  coord_cartesian(xlim= c(0,1.0))+
#  geom_abline(intercept = 0, slope = 1, alpha = 0.5) +
#  coord_equal(ratio=1) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 20, face = 'bold'),
panel.background = element_blank(), axis.line = element_line(colour = "black"),axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"), legend.text = element_text(size = 18), legend.title = element_text(size=20,face="bold")) + scale_colour_hue(l=40)
ggsave('~/Dropbox (Princeton)/Notes/research/adamson_gitai_wingreen/slides/Figures/2020-09-01/fixation_relative_abundance.png')
t.test(subset(subset(g, Sample == 'Post Fixation'), Fixation == '1'), subset(subset(g, Sample == 'Post Fixation'), Fixation == '4'))
subset(subset(g, Sample == 'Post Fixation'), Fixation == '1')
t.test(subset(subset(g, Sample == 'Post Fixation'), Fixation == '1')[CT_x], subset(subset(g, Sample == 'Post Fixation')[CT_x]                                         , Fixation == '4'))
t.test(subset(subset(g, Sample == 'Post Fixation'), Fixation == '1')['CT_x'], subset(subset(g, Sample == 'Post Fixation'), Fixation == '4')['CT_x'])
